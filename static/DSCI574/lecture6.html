<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="lecture6_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture6_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture6_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture6_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture6_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lecture6_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="">
  <title>Lecture 6</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture6_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture6_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lecture6_files/libs/revealjs/dist/theme/quarto-2f366650f320edcfcf53d73c80250a32.css">
  <link rel="stylesheet" href="styles.css">
  <link href="lecture6_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture6_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture6_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture6_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="lecture6_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="lecture6_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <script type="text/javascript">
  window.PlotlyConfig = {MathJaxConfig: 'local'};
  if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
  if (typeof require !== 'undefined') {
  require.undef("plotly");
  requirejs.config({
      paths: {
          'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
      }
  });
  require(['plotly'], function(Plotly) {
      window._Plotly = Plotly;
  });
  }
  </script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 6</h1>
  <p class="subtitle">Advanced Time Series Modelling</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="learning-objectives" class="title-slide slide level2 center">
<h2>Learning objectives</h2>
<ul>
<li class="fragment">Develop a neural network for time series forecasting in <code>pytorch</code>.</li>
<li class="fragment">Understand how a <strong>recurrent neural network</strong> differs to a standard feed-forward network and why they are good for sequential data. <!-- - Describe how a **long short-term memory network** differs to a recurrent neural network. --></li>
</ul>
<aside class="notes">
<ul>
<li>I will try to finish the lecture within one hour without break.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>

<section>
<section id="most-real-world-data-is-time-series-data" class="title-slide slide level2 center">
<h2>Most real world data is time series data!</h2>
<ul>
<li class="fragment">Finance: stock prices</li>
<li class="fragment">Recommendation systems: user activity logs<br>
</li>
<li class="fragment">Ticket sales</li>
<li class="fragment">many more!</li>
</ul>
</section>
<section id="example-nomi-forecast-predicts-future-cash-flow" class="slide level4">
<h4>Example: NOMI Forecast predicts future cash flow</h4>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="nomi.jpeg" style="width:80.0%"></p>
</div><div class="column" style="width:60%;">
<table class="caption-top">
<thead>
<tr class="header">
<th>Date</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>March, 1</td>
<td>-$43</td>
</tr>
<tr class="even">
<td>March, 2</td>
<td>$500</td>
</tr>
<tr class="odd">
<td>March, 3</td>
<td>-$5</td>
</tr>
<tr class="even">
<td>March, 4</td>
<td>-$102</td>
</tr>
<tr class="odd">
<td>March, 5</td>
<td>?</td>
</tr>
</tbody>
</table>
<ul>
<li class="fragment">Goal: predict future cash flow.</li>
</ul>
</div></div>
</section>
<section id="why-using-deep-learning-for-real-world-time-series-data" class="title-slide slide level3 center">
<h3>Why using deep learning for real world time series data?</h3>
<ul>
<li class="fragment">Traditional methods are primarily designed for univariate time series data.</li>
<li class="fragment">But limited when it comes to handling additional features or multivariate data.</li>
</ul>
</section>
<section id="back-to-nomi-example" class="slide level4">
<h4>Back to NOMI example</h4>
<table class="caption-top">
<thead>
<tr class="header">
<th>Date</th>
<th>Type</th>
<th>Occupation</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>March, 1</td>
<td>Meal</td>
<td>Student</td>
<td>-$43</td>
</tr>
<tr class="even">
<td>March, 2</td>
<td>Direct deposit</td>
<td>Student</td>
<td>$500</td>
</tr>
<tr class="odd">
<td>March, 3</td>
<td>Coffee</td>
<td>Student</td>
<td>-$5</td>
</tr>
<tr class="even">
<td>March, 4</td>
<td>Grocery</td>
<td>Student</td>
<td>-$102</td>
</tr>
<tr class="odd">
<td>March, 5</td>
<td></td>
<td></td>
<td>?</td>
</tr>
</tbody>
</table>
<ul>
<li class="fragment">Ideally we want to use all the information available to predict future cash flow.</li>
</ul>
</section>
</section>
<section>
<section id="neural-networks-for-time-series-data" class="title-slide slide level2 center">
<h2>Neural networks for time series data</h2>
<ul>
<li class="fragment">Similar to using ML models for time series data in lecture 4.</li>
<li class="fragment">Data look like this:</li>
</ul>
<div class="fragment">
<table class="caption-top">
<thead>
<tr class="header">
<th>Time</th>
<th>Target</th>
<th>Lag-1</th>
<th>Lag-2</th>
<th>Lag-3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Day 1</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td>Day 2</td>
<td>8</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>Day 3</td>
<td>2</td>
<td>8</td>
<td>4</td>
<td>NaN</td>
</tr>
<tr class="even">
<td>Day 4</td>
<td>5</td>
<td>2</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<ul>
<li class="fragment">Train a NN that inputs <span class="math inline">\(X\)</span>, outputs <span class="math inline">\(Y\)</span>.</li>
</ul>
<aside class="notes">
<ul>
<li>Say that we can add more features to the input.</li>
<li>Draw the input and output from the table.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="nns-provide-a-flexible-architecture" class="title-slide slide level3 center">
<h3>NNs provide a flexible architecture</h3>
<ul>
<li class="fragment">Support non-linear relationships.</li>
<li class="fragment">Support multivariate inputs/outputs.</li>
<li class="fragment">Support classification.</li>
</ul>
</section>

<section id="q-what-are-the-potential-issues-using-neural-networks-for-time-series-data" class="title-slide slide level3 center">
<h3>Q: what are the potential issues using neural networks for time series data?</h3>
<div class="fragment">
<table class="caption-top">
<thead>
<tr class="header">
<th>Time</th>
<th>Target</th>
<th>Lag-1</th>
<th>Lag-2</th>
<th>Lag-3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Day 4</td>
<td>5</td>
<td>2</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<ul>
<li class="fragment"><p>We throw away some temporal information when we convert time series data to tabular data.</p></li>
<li class="fragment"><p>The model may not be able to capture long term temporal dependencies.</p></li>
</ul>
</div>
</section>
</section>
<section>
<section id="recurrent-neural-networks-rnn" class="title-slide slide level2 center">
<h2>Recurrent neural networks (RNN)</h2>
<ul>
<li class="fragment">RNN are NN that are designed for sequential data.</li>
<li class="fragment">Learning memory of the past to predict the future.</li>
</ul>
<aside class="notes">
<ul>
<li>Define sequence data</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="rnn-architecture" class="slide level4">
<h4>RNN architecture</h4>
</section>
<section id="backpropagation-through-time" class="slide level4">
<h4>Backpropagation through time</h4>
<p><img data-src="rnn.jpeg"></p>
</section>
<section id="rnn-in-pytorch-data" class="slide level4">
<h4>RNN in <code>pytorch</code>: data</h4>
<div id="470a7998" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>                            <div id="5c929d3c-70fd-4b66-aa06-24ce37c5ba7b" class="plotly-graph-div" style="height:525px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5c929d3c-70fd-4b66-aa06-24ce37c5ba7b")) {                    Plotly.newPlot(                        "5c929d3c-70fd-4b66-aa06-24ce37c5ba7b",                        [{"hovertemplate":"Label=Train\u003cbr\u003eTime=%{x}\u003cbr\u003eUnemployed persons=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Train","orientation":"v","showlegend":true,"x":["1991-01-31T00:00:00","1991-02-28T00:00:00","1991-03-31T00:00:00","1991-04-30T00:00:00","1991-05-31T00:00:00","1991-06-30T00:00:00","1991-07-31T00:00:00","1991-08-31T00:00:00","1991-09-30T00:00:00","1991-10-31T00:00:00","1991-11-30T00:00:00","1991-12-31T00:00:00","1992-01-31T00:00:00","1992-02-29T00:00:00","1992-03-31T00:00:00","1992-04-30T00:00:00","1992-05-31T00:00:00","1992-06-30T00:00:00","1992-07-31T00:00:00","1992-08-31T00:00:00","1992-09-30T00:00:00","1992-10-31T00:00:00","1992-11-30T00:00:00","1992-12-31T00:00:00","1993-01-31T00:00:00","1993-02-28T00:00:00","1993-03-31T00:00:00","1993-04-30T00:00:00","1993-05-31T00:00:00","1993-06-30T00:00:00","1993-07-31T00:00:00","1993-08-31T00:00:00","1993-09-30T00:00:00","1993-10-31T00:00:00","1993-11-30T00:00:00","1993-12-31T00:00:00","1994-01-31T00:00:00","1994-02-28T00:00:00","1994-03-31T00:00:00","1994-04-30T00:00:00","1994-05-31T00:00:00","1994-06-30T00:00:00","1994-07-31T00:00:00","1994-08-31T00:00:00","1994-09-30T00:00:00","1994-10-31T00:00:00","1994-11-30T00:00:00","1994-12-31T00:00:00","1995-01-31T00:00:00","1995-02-28T00:00:00","1995-03-31T00:00:00","1995-04-30T00:00:00","1995-05-31T00:00:00","1995-06-30T00:00:00","1995-07-31T00:00:00","1995-08-31T00:00:00","1995-09-30T00:00:00","1995-10-31T00:00:00","1995-11-30T00:00:00","1995-12-31T00:00:00","1996-01-31T00:00:00","1996-02-29T00:00:00","1996-03-31T00:00:00","1996-04-30T00:00:00","1996-05-31T00:00:00","1996-06-30T00:00:00","1996-07-31T00:00:00","1996-08-31T00:00:00","1996-09-30T00:00:00","1996-10-31T00:00:00","1996-11-30T00:00:00","1996-12-31T00:00:00","1997-01-31T00:00:00","1997-02-28T00:00:00","1997-03-31T00:00:00","1997-04-30T00:00:00","1997-05-31T00:00:00","1997-06-30T00:00:00","1997-07-31T00:00:00","1997-08-31T00:00:00","1997-09-30T00:00:00","1997-10-31T00:00:00","1997-11-30T00:00:00","1997-12-31T00:00:00","1998-01-31T00:00:00","1998-02-28T00:00:00","1998-03-31T00:00:00","1998-04-30T00:00:00","1998-05-31T00:00:00","1998-06-30T00:00:00","1998-07-31T00:00:00","1998-08-31T00:00:00","1998-09-30T00:00:00","1998-10-31T00:00:00","1998-11-30T00:00:00","1998-12-31T00:00:00","1999-01-31T00:00:00","1999-02-28T00:00:00","1999-03-31T00:00:00","1999-04-30T00:00:00","1999-05-31T00:00:00","1999-06-30T00:00:00","1999-07-31T00:00:00","1999-08-31T00:00:00","1999-09-30T00:00:00","1999-10-31T00:00:00","1999-11-30T00:00:00","1999-12-31T00:00:00","2000-01-31T00:00:00","2000-02-29T00:00:00","2000-03-31T00:00:00","2000-04-30T00:00:00","2000-05-31T00:00:00","2000-06-30T00:00:00","2000-07-31T00:00:00","2000-08-31T00:00:00","2000-09-30T00:00:00","2000-10-31T00:00:00","2000-11-30T00:00:00","2000-12-31T00:00:00","2001-01-31T00:00:00","2001-02-28T00:00:00","2001-03-31T00:00:00","2001-04-30T00:00:00","2001-05-31T00:00:00","2001-06-30T00:00:00","2001-07-31T00:00:00","2001-08-31T00:00:00","2001-09-30T00:00:00","2001-10-31T00:00:00","2001-11-30T00:00:00","2001-12-31T00:00:00","2002-01-31T00:00:00","2002-02-28T00:00:00","2002-03-31T00:00:00","2002-04-30T00:00:00","2002-05-31T00:00:00","2002-06-30T00:00:00","2002-07-31T00:00:00","2002-08-31T00:00:00","2002-09-30T00:00:00","2002-10-31T00:00:00","2002-11-30T00:00:00","2002-12-31T00:00:00","2003-01-31T00:00:00","2003-02-28T00:00:00","2003-03-31T00:00:00","2003-04-30T00:00:00","2003-05-31T00:00:00","2003-06-30T00:00:00","2003-07-31T00:00:00","2003-08-31T00:00:00","2003-09-30T00:00:00","2003-10-31T00:00:00","2003-11-30T00:00:00","2003-12-31T00:00:00","2004-01-31T00:00:00","2004-02-29T00:00:00","2004-03-31T00:00:00","2004-04-30T00:00:00","2004-05-31T00:00:00","2004-06-30T00:00:00","2004-07-31T00:00:00","2004-08-31T00:00:00","2004-09-30T00:00:00","2004-10-31T00:00:00","2004-11-30T00:00:00","2004-12-31T00:00:00","2005-01-31T00:00:00","2005-02-28T00:00:00","2005-03-31T00:00:00","2005-04-30T00:00:00","2005-05-31T00:00:00","2005-06-30T00:00:00","2005-07-31T00:00:00","2005-08-31T00:00:00","2005-09-30T00:00:00","2005-10-31T00:00:00","2005-11-30T00:00:00","2005-12-31T00:00:00","2006-01-31T00:00:00","2006-02-28T00:00:00","2006-03-31T00:00:00","2006-04-30T00:00:00","2006-05-31T00:00:00","2006-06-30T00:00:00","2006-07-31T00:00:00","2006-08-31T00:00:00","2006-09-30T00:00:00","2006-10-31T00:00:00","2006-11-30T00:00:00","2006-12-31T00:00:00","2007-01-31T00:00:00","2007-02-28T00:00:00","2007-03-31T00:00:00","2007-04-30T00:00:00","2007-05-31T00:00:00","2007-06-30T00:00:00","2007-07-31T00:00:00","2007-08-31T00:00:00","2007-09-30T00:00:00","2007-10-31T00:00:00","2007-11-30T00:00:00","2007-12-31T00:00:00","2008-01-31T00:00:00","2008-02-29T00:00:00","2008-03-31T00:00:00","2008-04-30T00:00:00","2008-05-31T00:00:00","2008-06-30T00:00:00","2008-07-31T00:00:00","2008-08-31T00:00:00","2008-09-30T00:00:00","2008-10-31T00:00:00","2008-11-30T00:00:00","2008-12-31T00:00:00","2009-01-31T00:00:00","2009-02-28T00:00:00","2009-03-31T00:00:00","2009-04-30T00:00:00","2009-05-31T00:00:00","2009-06-30T00:00:00","2009-07-31T00:00:00","2009-08-31T00:00:00","2009-09-30T00:00:00","2009-10-31T00:00:00","2009-11-30T00:00:00","2009-12-31T00:00:00","2010-01-31T00:00:00","2010-02-28T00:00:00","2010-03-31T00:00:00","2010-04-30T00:00:00","2010-05-31T00:00:00","2010-06-30T00:00:00","2010-07-31T00:00:00","2010-08-31T00:00:00","2010-09-30T00:00:00","2010-10-31T00:00:00","2010-11-30T00:00:00","2010-12-31T00:00:00","2011-01-31T00:00:00","2011-02-28T00:00:00","2011-03-31T00:00:00","2011-04-30T00:00:00","2011-05-31T00:00:00","2011-06-30T00:00:00","2011-07-31T00:00:00","2011-08-31T00:00:00","2011-09-30T00:00:00","2011-10-31T00:00:00","2011-11-30T00:00:00","2011-12-31T00:00:00","2012-01-31T00:00:00","2012-02-29T00:00:00","2012-03-31T00:00:00","2012-04-30T00:00:00","2012-05-31T00:00:00","2012-06-30T00:00:00","2012-07-31T00:00:00","2012-08-31T00:00:00","2012-09-30T00:00:00","2012-10-31T00:00:00","2012-11-30T00:00:00","2012-12-31T00:00:00"],"xaxis":"x","y":[763321.6342,807546.6346,818667.6259,849493.4822,805407.9362,757682.9427,797379.07,796614.4527,854132.2661,789031.7782,806171.3059,906003.6808,948552.3268,982766.7093,935272.2071,894588.3631000001,901690.0915,894791.6715,904773.9405,886237.5365,910346.127,893743.9917,888238.2838,969202.417,998921.8324,1039332.3803,972360.6533,920874.0118,915407.29,911184.4007,885170.2863,909499.7134,927444.6442,892594.4961,892882.3594000001,939282.7591,983463.237,1005079.581,945000.6625,876426.4531,844441.9787000001,828612.4326000001,798735.2938999999,796098.5107999999,829323.8282,750942.6261999999,755044.1625,791015.9059,836355.7256,873726.8519,804056.4894000001,737776.0684,750830.7972,723459.2261,708794.7423,718945.2359,756767.4555,725747.5482999999,719942.9847,736036.7399,817714.7073,839721.8402,799197.0913,782174.3214,758056.9203,723809.9243000001,727322.3828,763632.8692,785366.8098,751867.3334,722859.4813,786889.1190000001,833121.7712,886858.6258,823724.7357999999,785112.5851,774946.9481,735209.2682,731421.0941999999,743432.9501,744672.3833,692065.9114,690770.9965,720463.6632000001,770069.9041,794682.0360000001,757876.6510000001,702906.8089,711195.3804,702784.079,686717.6799999999,690220.3426,716070.3934,640418.7194,665349.6727,659091.475,702528.1191,735769.0122,683544.8656,652779.3847,649018.6814,600573.4614,575481.4913999999,619694.8093,668821.2084,600300.2602,565695.7448000001,625715.0635,674754.3041000001,699238.1039000001,652837.6317,612157.4974999999,607304.3193,564324.5278,525575.0458999999,556138.1076,578095.5765,541093.4644,557373.1459,592152.7919000001,625737.7819,700364.2790999999,650197.4321,663626.9367999999,664228.7742,651512.4036,611867.0512,638136.5602,671245.1108,657921.2055,626306.7243,660031.7297,734816.9928,719874.1529,660003.7071,625695.9254,620852.256,619679.6046,552983.1509,595163.735,631442.3230999999,566173.374,565921.0756,607375.6835,663046.1558,673188.7693,642900.8734,608867.6707,605881.6272999999,587553.4893,557621.8375,552363.1046000001,583839.0272,544310.0713,523404.1318,563449.0053,603777.5316,640791.0819999999,575855.5785999999,561834.5207,538088.1862,537292.8021,512297.9103,529354.3759,551260.0005000001,490117.7871,485876.2342,514070.6967,568923.6013,592010.4568,565345.8876,539479.2673,530688.6026,502547.5118,473550.0571,486578.0659,527707.0802,494026.3603,476382.3279,525846.9509,591515.3355,606729.8774,542772.9119000001,533001.8402,509866.5565,498203.9136,454627.3625,477456.1887,504452.337,449612.6423,446660.7525,486950.6156,534529.0017,567165.7272999999,512000.1281,483360.5365000001,465273.0059,459011.3248,426056.9857,446790.0621,465561.1537,449440.6812,451341.80529999995,470763.7154,503339.1936,500359.6899,479675.3457,484106.4385000001,478292.3884,462684.4882,439836.4802,429363.5785,484854.9269,458671.0019,465872.0176,506516.1596,600017.5636,683919.1205,692978.0099,637016.0525,667518.1922,654734.4765,601720.1055000001,623537.3613,647175.9748,613696.8988999999,593448.8303,619132.7999999999,654089.7793,690541.2705,666557.7885,642749.2554,604614.1035000001,580301.9453,572037.07,559282.2219,592065.9826,589809.4069,558233.4409,561536.6884999999,631061.7594,662687.7726,619232.4082000001,588206.156,589836.1664999999,564216.1214000001,562519.8415,596761.3242,620140.9733000001,588553.5235,578163.0754,602044.8335,642339.2291,699604.8415,659861.6174,599286.2944,620938.1901,599270.207,583375.407,590767.867,661091.2471,623619.0531,589172.4500000001,637828.4158],"yaxis":"y","type":"scatter"},{"hovertemplate":"Label=Test\u003cbr\u003eTime=%{x}\u003cbr\u003eUnemployed persons=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Test","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Test","orientation":"v","showlegend":true,"x":["2013-01-31T00:00:00","2013-02-28T00:00:00","2013-03-31T00:00:00","2013-04-30T00:00:00","2013-05-31T00:00:00","2013-06-30T00:00:00","2013-07-31T00:00:00","2013-08-31T00:00:00","2013-09-30T00:00:00","2013-10-31T00:00:00","2013-11-30T00:00:00","2013-12-31T00:00:00","2014-01-31T00:00:00","2014-02-28T00:00:00","2014-03-31T00:00:00","2014-04-30T00:00:00","2014-05-31T00:00:00","2014-06-30T00:00:00","2014-07-31T00:00:00","2014-08-31T00:00:00","2014-09-30T00:00:00","2014-10-31T00:00:00","2014-11-30T00:00:00","2014-12-31T00:00:00","2015-01-31T00:00:00","2015-02-28T00:00:00","2015-03-31T00:00:00","2015-04-30T00:00:00","2015-05-31T00:00:00","2015-06-30T00:00:00","2015-07-31T00:00:00","2015-08-31T00:00:00","2015-09-30T00:00:00","2015-10-31T00:00:00","2015-11-30T00:00:00","2015-12-31T00:00:00","2016-01-31T00:00:00","2016-02-29T00:00:00","2016-03-31T00:00:00","2016-04-30T00:00:00","2016-05-31T00:00:00","2016-06-30T00:00:00","2016-07-31T00:00:00","2016-08-31T00:00:00","2016-09-30T00:00:00","2016-10-31T00:00:00","2016-11-30T00:00:00","2016-12-31T00:00:00","2017-01-31T00:00:00","2017-02-28T00:00:00","2017-03-31T00:00:00","2017-04-30T00:00:00","2017-05-31T00:00:00","2017-06-30T00:00:00","2017-07-31T00:00:00","2017-08-31T00:00:00","2017-09-30T00:00:00","2017-10-31T00:00:00","2017-11-30T00:00:00","2017-12-31T00:00:00","2018-01-31T00:00:00","2018-02-28T00:00:00","2018-03-31T00:00:00","2018-04-30T00:00:00","2018-05-31T00:00:00","2018-06-30T00:00:00","2018-07-31T00:00:00","2018-08-31T00:00:00","2018-09-30T00:00:00","2018-10-31T00:00:00","2018-11-30T00:00:00","2018-12-31T00:00:00","2019-01-31T00:00:00","2019-02-28T00:00:00","2019-03-31T00:00:00","2019-04-30T00:00:00","2019-05-31T00:00:00","2019-06-30T00:00:00","2019-07-31T00:00:00","2019-08-31T00:00:00","2019-09-30T00:00:00","2019-10-31T00:00:00","2019-11-30T00:00:00","2019-12-31T00:00:00","2020-01-31T00:00:00","2020-02-29T00:00:00","2020-03-31T00:00:00","2020-04-30T00:00:00","2020-05-31T00:00:00","2020-06-30T00:00:00","2020-07-31T00:00:00","2020-08-31T00:00:00","2020-09-30T00:00:00","2020-10-31T00:00:00","2020-11-30T00:00:00","2020-12-31T00:00:00","2021-01-31T00:00:00","2021-02-28T00:00:00"],"xaxis":"x","y":[626874.0676,670982.2388,656087.4219999999,612906.2991,606906.1812999999,603400.5686,577175.8145999999,610978.9535,623354.4513000001,610432.5743000001,587581.0212,624620.1289,702082.9283,767165.5998999999,696811.0356,644227.0759,647935.8301,651813.8837,671710.6201000001,663830.6401,676417.5676999999,681959.3601,653762.6939000001,661952.4648000001,767640.0707,767487.3114,738788.7232,694677.7651999999,660191.0352,659704.4028,700960.1549,690322.8751000001,683557.1166,643745.3765,619076.1048000001,632985.6324,746081.7505,717835.9465,692266.7934,649364.9394,645139.7025,633539.9532,638771.0206,638066.1165,625955.3932,606406.266,613957.8835,653227.9911000001,707649.8301,750273.4704,733379.7174,660721.5679,634480.9488,636145.1316,642323.6165,644557.6690999999,622485.7848,596824.7599,591358.6177,646929.9177,710055.8339000001,735671.7929,707802.0342,670584.1305,632170.9654,617891.2159000001,619922.4324,628353.137,578354.2446999999,564151.7512,564775.8963,578774.2115999999,656908.8061,657804.7711,661765.0665,643955.7535999999,624322.3637999999,621955.3252,632613.8006,644384.1872,621793.7511,615821.0552000001,583741.6982,597014.7254,705109.154,691145.3848,695560.5034,780478.3247,834686.9262999999,896530.8047,924679.9045,851887.1787,839431.998,837488.3606,805185.9905,803269.2088,868048.5686,804475.8031],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Time"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Unemployed persons"}},"legend":{"title":{"text":"Label"},"tracegroupgap":0},"title":{"text":"Australian Unemployment"},"width":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5c929d3c-70fd-4b66-aa06-24ce37c5ba7b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="rnn-in-pytorch" class="slide level4">
<h4>RNN in <code>pytorch</code></h4>
<div id="b2a31b83" class="cell" data-fig-height="7" data-fig-width="11.5" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="co"># define network</span></span>
<span id="cb1-2"><a href=""></a><span class="kw">class</span> RNN(nn.Module):</span>
<span id="cb1-3"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, output_size, hidden_dim):</span>
<span id="cb1-4"><a href=""></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb1-5"><a href=""></a>        <span class="va">self</span>.hidden_dim <span class="op">=</span> hidden_dim</span>
<span id="cb1-6"><a href=""></a>        <span class="va">self</span>.rnn_cell <span class="op">=</span> nn.RNN(input_size, hidden_dim, batch_first<span class="op">=</span><span class="va">True</span>, num_layers<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href=""></a>        <span class="va">self</span>.fc <span class="op">=</span> nn.Linear(hidden_dim, output_size)</span>
<span id="cb1-8"><a href=""></a></span>
<span id="cb1-9"><a href=""></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, hidden):</span>
<span id="cb1-10"><a href=""></a>        <span class="co"># x: (batch_size, seq_length, input_size)</span></span>
<span id="cb1-11"><a href=""></a>        <span class="co"># hidden: (1, batch_size, hidden_size)</span></span>
<span id="cb1-12"><a href=""></a>        prediction, hidden <span class="op">=</span> <span class="va">self</span>.rnn_cell(x, hidden)</span>
<span id="cb1-13"><a href=""></a>        output <span class="op">=</span> <span class="va">self</span>.fc(prediction)</span>
<span id="cb1-14"><a href=""></a>        <span class="co"># output: (batch_size, seq_length, output_size)</span></span>
<span id="cb1-15"><a href=""></a>        <span class="co"># hidden: (1, batch_size, hidden_size)</span></span>
<span id="cb1-16"><a href=""></a>        <span class="cf">return</span> output[:, <span class="op">-</span><span class="dv">1</span>, :], hidden</span>
<span id="cb1-17"><a href=""></a></span>
<span id="cb1-18"><a href=""></a><span class="co"># train network</span></span>
<span id="cb1-19"><a href=""></a>model <span class="op">=</span> RNN(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-20"><a href=""></a>optimizer <span class="op">=</span> optim.Adam(model.parameters()) <span class="co"># your can use other optimizers</span></span>
<span id="cb1-21"><a href=""></a>criterion <span class="op">=</span> nn.MSELoss() <span class="co"># you can use other loss functions</span></span>
<span id="cb1-22"><a href=""></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">201</span>):</span>
<span id="cb1-23"><a href=""></a>    <span class="cf">for</span> X, y <span class="kw">in</span> dataloader:</span>
<span id="cb1-24"><a href=""></a>        memory <span class="op">=</span> <span class="va">None</span> <span class="co"># torch.zeros(1, batch_size, hidden_size)</span></span>
<span id="cb1-25"><a href=""></a>        optimizer.zero_grad()</span>
<span id="cb1-26"><a href=""></a>        y_hat, _ <span class="op">=</span> model(X, memory)</span>
<span id="cb1-27"><a href=""></a>        loss <span class="op">=</span> criterion(y_hat.flatten(), y)</span>
<span id="cb1-28"><a href=""></a>        loss.backward()</span>
<span id="cb1-29"><a href=""></a>        optimizer.step()</span>
<span id="cb1-30"><a href=""></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb1-31"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">:03}</span><span class="ss">. Loss = </span><span class="sc">{</span>loss<span class="sc">.</span>item()<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 020. Loss = 0.0785
Epoch 040. Loss = 0.0648
Epoch 060. Loss = 0.0576
Epoch 080. Loss = 0.0519
Epoch 100. Loss = 0.0470
Epoch 120. Loss = 0.0432
Epoch 140. Loss = 0.0407
Epoch 160. Loss = 0.0398
Epoch 180. Loss = 0.0397
Epoch 200. Loss = 0.0398</code></pre>
</div>
</div>
</section>
<section id="different-implementaion-of-truncated-backpropagation" class="slide level4">
<h4>Different implementaion of truncated backpropagation</h4>
<ul>
<li class="fragment">Stateless: no memory between batches.</li>
<li class="fragment">Stateful: carry over hidden states between batches.</li>
<li class="fragment"><a href="https://r2rt.com/styles-of-truncated-backpropagation.html">Styles of truncated backpropagation</a></li>
</ul>
</section>
<section id="rnn-in-pytorch-prediction" class="slide level4">
<h4>RNN in <code>pytorch</code>: prediction</h4>
<div id="3fab40b6" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>                            <div id="31fd0a7c-f1c5-4619-a4a0-c99d6b980700" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("31fd0a7c-f1c5-4619-a4a0-c99d6b980700")) {                    Plotly.newPlot(                        "31fd0a7c-f1c5-4619-a4a0-c99d6b980700",                        [{"hovertemplate":"Label=Train\u003cbr\u003eTime=%{x}\u003cbr\u003eUnemployed persons=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Train","orientation":"v","showlegend":true,"x":["1991-01-31T00:00:00","1991-02-28T00:00:00","1991-03-31T00:00:00","1991-04-30T00:00:00","1991-05-31T00:00:00","1991-06-30T00:00:00","1991-07-31T00:00:00","1991-08-31T00:00:00","1991-09-30T00:00:00","1991-10-31T00:00:00","1991-11-30T00:00:00","1991-12-31T00:00:00","1992-01-31T00:00:00","1992-02-29T00:00:00","1992-03-31T00:00:00","1992-04-30T00:00:00","1992-05-31T00:00:00","1992-06-30T00:00:00","1992-07-31T00:00:00","1992-08-31T00:00:00","1992-09-30T00:00:00","1992-10-31T00:00:00","1992-11-30T00:00:00","1992-12-31T00:00:00","1993-01-31T00:00:00","1993-02-28T00:00:00","1993-03-31T00:00:00","1993-04-30T00:00:00","1993-05-31T00:00:00","1993-06-30T00:00:00","1993-07-31T00:00:00","1993-08-31T00:00:00","1993-09-30T00:00:00","1993-10-31T00:00:00","1993-11-30T00:00:00","1993-12-31T00:00:00","1994-01-31T00:00:00","1994-02-28T00:00:00","1994-03-31T00:00:00","1994-04-30T00:00:00","1994-05-31T00:00:00","1994-06-30T00:00:00","1994-07-31T00:00:00","1994-08-31T00:00:00","1994-09-30T00:00:00","1994-10-31T00:00:00","1994-11-30T00:00:00","1994-12-31T00:00:00","1995-01-31T00:00:00","1995-02-28T00:00:00","1995-03-31T00:00:00","1995-04-30T00:00:00","1995-05-31T00:00:00","1995-06-30T00:00:00","1995-07-31T00:00:00","1995-08-31T00:00:00","1995-09-30T00:00:00","1995-10-31T00:00:00","1995-11-30T00:00:00","1995-12-31T00:00:00","1996-01-31T00:00:00","1996-02-29T00:00:00","1996-03-31T00:00:00","1996-04-30T00:00:00","1996-05-31T00:00:00","1996-06-30T00:00:00","1996-07-31T00:00:00","1996-08-31T00:00:00","1996-09-30T00:00:00","1996-10-31T00:00:00","1996-11-30T00:00:00","1996-12-31T00:00:00","1997-01-31T00:00:00","1997-02-28T00:00:00","1997-03-31T00:00:00","1997-04-30T00:00:00","1997-05-31T00:00:00","1997-06-30T00:00:00","1997-07-31T00:00:00","1997-08-31T00:00:00","1997-09-30T00:00:00","1997-10-31T00:00:00","1997-11-30T00:00:00","1997-12-31T00:00:00","1998-01-31T00:00:00","1998-02-28T00:00:00","1998-03-31T00:00:00","1998-04-30T00:00:00","1998-05-31T00:00:00","1998-06-30T00:00:00","1998-07-31T00:00:00","1998-08-31T00:00:00","1998-09-30T00:00:00","1998-10-31T00:00:00","1998-11-30T00:00:00","1998-12-31T00:00:00","1999-01-31T00:00:00","1999-02-28T00:00:00","1999-03-31T00:00:00","1999-04-30T00:00:00","1999-05-31T00:00:00","1999-06-30T00:00:00","1999-07-31T00:00:00","1999-08-31T00:00:00","1999-09-30T00:00:00","1999-10-31T00:00:00","1999-11-30T00:00:00","1999-12-31T00:00:00","2000-01-31T00:00:00","2000-02-29T00:00:00","2000-03-31T00:00:00","2000-04-30T00:00:00","2000-05-31T00:00:00","2000-06-30T00:00:00","2000-07-31T00:00:00","2000-08-31T00:00:00","2000-09-30T00:00:00","2000-10-31T00:00:00","2000-11-30T00:00:00","2000-12-31T00:00:00","2001-01-31T00:00:00","2001-02-28T00:00:00","2001-03-31T00:00:00","2001-04-30T00:00:00","2001-05-31T00:00:00","2001-06-30T00:00:00","2001-07-31T00:00:00","2001-08-31T00:00:00","2001-09-30T00:00:00","2001-10-31T00:00:00","2001-11-30T00:00:00","2001-12-31T00:00:00","2002-01-31T00:00:00","2002-02-28T00:00:00","2002-03-31T00:00:00","2002-04-30T00:00:00","2002-05-31T00:00:00","2002-06-30T00:00:00","2002-07-31T00:00:00","2002-08-31T00:00:00","2002-09-30T00:00:00","2002-10-31T00:00:00","2002-11-30T00:00:00","2002-12-31T00:00:00","2003-01-31T00:00:00","2003-02-28T00:00:00","2003-03-31T00:00:00","2003-04-30T00:00:00","2003-05-31T00:00:00","2003-06-30T00:00:00","2003-07-31T00:00:00","2003-08-31T00:00:00","2003-09-30T00:00:00","2003-10-31T00:00:00","2003-11-30T00:00:00","2003-12-31T00:00:00","2004-01-31T00:00:00","2004-02-29T00:00:00","2004-03-31T00:00:00","2004-04-30T00:00:00","2004-05-31T00:00:00","2004-06-30T00:00:00","2004-07-31T00:00:00","2004-08-31T00:00:00","2004-09-30T00:00:00","2004-10-31T00:00:00","2004-11-30T00:00:00","2004-12-31T00:00:00","2005-01-31T00:00:00","2005-02-28T00:00:00","2005-03-31T00:00:00","2005-04-30T00:00:00","2005-05-31T00:00:00","2005-06-30T00:00:00","2005-07-31T00:00:00","2005-08-31T00:00:00","2005-09-30T00:00:00","2005-10-31T00:00:00","2005-11-30T00:00:00","2005-12-31T00:00:00","2006-01-31T00:00:00","2006-02-28T00:00:00","2006-03-31T00:00:00","2006-04-30T00:00:00","2006-05-31T00:00:00","2006-06-30T00:00:00","2006-07-31T00:00:00","2006-08-31T00:00:00","2006-09-30T00:00:00","2006-10-31T00:00:00","2006-11-30T00:00:00","2006-12-31T00:00:00","2007-01-31T00:00:00","2007-02-28T00:00:00","2007-03-31T00:00:00","2007-04-30T00:00:00","2007-05-31T00:00:00","2007-06-30T00:00:00","2007-07-31T00:00:00","2007-08-31T00:00:00","2007-09-30T00:00:00","2007-10-31T00:00:00","2007-11-30T00:00:00","2007-12-31T00:00:00","2008-01-31T00:00:00","2008-02-29T00:00:00","2008-03-31T00:00:00","2008-04-30T00:00:00","2008-05-31T00:00:00","2008-06-30T00:00:00","2008-07-31T00:00:00","2008-08-31T00:00:00","2008-09-30T00:00:00","2008-10-31T00:00:00","2008-11-30T00:00:00","2008-12-31T00:00:00","2009-01-31T00:00:00","2009-02-28T00:00:00","2009-03-31T00:00:00","2009-04-30T00:00:00","2009-05-31T00:00:00","2009-06-30T00:00:00","2009-07-31T00:00:00","2009-08-31T00:00:00","2009-09-30T00:00:00","2009-10-31T00:00:00","2009-11-30T00:00:00","2009-12-31T00:00:00","2010-01-31T00:00:00","2010-02-28T00:00:00","2010-03-31T00:00:00","2010-04-30T00:00:00","2010-05-31T00:00:00","2010-06-30T00:00:00","2010-07-31T00:00:00","2010-08-31T00:00:00","2010-09-30T00:00:00","2010-10-31T00:00:00","2010-11-30T00:00:00","2010-12-31T00:00:00","2011-01-31T00:00:00","2011-02-28T00:00:00","2011-03-31T00:00:00","2011-04-30T00:00:00","2011-05-31T00:00:00","2011-06-30T00:00:00","2011-07-31T00:00:00","2011-08-31T00:00:00","2011-09-30T00:00:00","2011-10-31T00:00:00","2011-11-30T00:00:00","2011-12-31T00:00:00","2012-01-31T00:00:00","2012-02-29T00:00:00","2012-03-31T00:00:00","2012-04-30T00:00:00","2012-05-31T00:00:00","2012-06-30T00:00:00","2012-07-31T00:00:00","2012-08-31T00:00:00","2012-09-30T00:00:00","2012-10-31T00:00:00","2012-11-30T00:00:00","2012-12-31T00:00:00"],"xaxis":"x","y":[763321.6342,807546.6346,818667.6259,849493.4822,805407.9362,757682.9427,797379.07,796614.4527,854132.2661,789031.7782,806171.3059,906003.6808,948552.3268,982766.7093,935272.2071,894588.3631000001,901690.0915,894791.6715,904773.9405,886237.5365,910346.127,893743.9917,888238.2838,969202.417,998921.8324,1039332.3803,972360.6533,920874.0118,915407.29,911184.4007,885170.2863,909499.7134,927444.6442,892594.4961,892882.3594000001,939282.7591,983463.237,1005079.581,945000.6625,876426.4531,844441.9787000001,828612.4326000001,798735.2938999999,796098.5107999999,829323.8282,750942.6261999999,755044.1625,791015.9059,836355.7256,873726.8519,804056.4894000001,737776.0684,750830.7972,723459.2261,708794.7423,718945.2359,756767.4555,725747.5482999999,719942.9847,736036.7399,817714.7073,839721.8402,799197.0913,782174.3214,758056.9203,723809.9243000001,727322.3828,763632.8692,785366.8098,751867.3334,722859.4813,786889.1190000001,833121.7712,886858.6258,823724.7357999999,785112.5851,774946.9481,735209.2682,731421.0941999999,743432.9501,744672.3833,692065.9114,690770.9965,720463.6632000001,770069.9041,794682.0360000001,757876.6510000001,702906.8089,711195.3804,702784.079,686717.6799999999,690220.3426,716070.3934,640418.7194,665349.6727,659091.475,702528.1191,735769.0122,683544.8656,652779.3847,649018.6814,600573.4614,575481.4913999999,619694.8093,668821.2084,600300.2602,565695.7448000001,625715.0635,674754.3041000001,699238.1039000001,652837.6317,612157.4974999999,607304.3193,564324.5278,525575.0458999999,556138.1076,578095.5765,541093.4644,557373.1459,592152.7919000001,625737.7819,700364.2790999999,650197.4321,663626.9367999999,664228.7742,651512.4036,611867.0512,638136.5602,671245.1108,657921.2055,626306.7243,660031.7297,734816.9928,719874.1529,660003.7071,625695.9254,620852.256,619679.6046,552983.1509,595163.735,631442.3230999999,566173.374,565921.0756,607375.6835,663046.1558,673188.7693,642900.8734,608867.6707,605881.6272999999,587553.4893,557621.8375,552363.1046000001,583839.0272,544310.0713,523404.1318,563449.0053,603777.5316,640791.0819999999,575855.5785999999,561834.5207,538088.1862,537292.8021,512297.9103,529354.3759,551260.0005000001,490117.7871,485876.2342,514070.6967,568923.6013,592010.4568,565345.8876,539479.2673,530688.6026,502547.5118,473550.0571,486578.0659,527707.0802,494026.3603,476382.3279,525846.9509,591515.3355,606729.8774,542772.9119000001,533001.8402,509866.5565,498203.9136,454627.3625,477456.1887,504452.337,449612.6423,446660.7525,486950.6156,534529.0017,567165.7272999999,512000.1281,483360.5365000001,465273.0059,459011.3248,426056.9857,446790.0621,465561.1537,449440.6812,451341.80529999995,470763.7154,503339.1936,500359.6899,479675.3457,484106.4385000001,478292.3884,462684.4882,439836.4802,429363.5785,484854.9269,458671.0019,465872.0176,506516.1596,600017.5636,683919.1205,692978.0099,637016.0525,667518.1922,654734.4765,601720.1055000001,623537.3613,647175.9748,613696.8988999999,593448.8303,619132.7999999999,654089.7793,690541.2705,666557.7885,642749.2554,604614.1035000001,580301.9453,572037.07,559282.2219,592065.9826,589809.4069,558233.4409,561536.6884999999,631061.7594,662687.7726,619232.4082000001,588206.156,589836.1664999999,564216.1214000001,562519.8415,596761.3242,620140.9733000001,588553.5235,578163.0754,602044.8335,642339.2291,699604.8415,659861.6174,599286.2944,620938.1901,599270.207,583375.407,590767.867,661091.2471,623619.0531,589172.4500000001,637828.4158],"yaxis":"y","type":"scatter"},{"hovertemplate":"Label=Test\u003cbr\u003eTime=%{x}\u003cbr\u003eUnemployed persons=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Test","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Test","orientation":"v","showlegend":true,"x":["2013-01-31T00:00:00","2013-02-28T00:00:00","2013-03-31T00:00:00","2013-04-30T00:00:00","2013-05-31T00:00:00","2013-06-30T00:00:00","2013-07-31T00:00:00","2013-08-31T00:00:00","2013-09-30T00:00:00","2013-10-31T00:00:00","2013-11-30T00:00:00","2013-12-31T00:00:00","2014-01-31T00:00:00","2014-02-28T00:00:00","2014-03-31T00:00:00","2014-04-30T00:00:00","2014-05-31T00:00:00","2014-06-30T00:00:00","2014-07-31T00:00:00","2014-08-31T00:00:00","2014-09-30T00:00:00","2014-10-31T00:00:00","2014-11-30T00:00:00","2014-12-31T00:00:00","2015-01-31T00:00:00","2015-02-28T00:00:00","2015-03-31T00:00:00","2015-04-30T00:00:00","2015-05-31T00:00:00","2015-06-30T00:00:00","2015-07-31T00:00:00","2015-08-31T00:00:00","2015-09-30T00:00:00","2015-10-31T00:00:00","2015-11-30T00:00:00","2015-12-31T00:00:00","2016-01-31T00:00:00","2016-02-29T00:00:00","2016-03-31T00:00:00","2016-04-30T00:00:00","2016-05-31T00:00:00","2016-06-30T00:00:00","2016-07-31T00:00:00","2016-08-31T00:00:00","2016-09-30T00:00:00","2016-10-31T00:00:00","2016-11-30T00:00:00","2016-12-31T00:00:00","2017-01-31T00:00:00","2017-02-28T00:00:00","2017-03-31T00:00:00","2017-04-30T00:00:00","2017-05-31T00:00:00","2017-06-30T00:00:00","2017-07-31T00:00:00","2017-08-31T00:00:00","2017-09-30T00:00:00","2017-10-31T00:00:00","2017-11-30T00:00:00","2017-12-31T00:00:00","2018-01-31T00:00:00","2018-02-28T00:00:00","2018-03-31T00:00:00","2018-04-30T00:00:00","2018-05-31T00:00:00","2018-06-30T00:00:00","2018-07-31T00:00:00","2018-08-31T00:00:00","2018-09-30T00:00:00","2018-10-31T00:00:00","2018-11-30T00:00:00","2018-12-31T00:00:00","2019-01-31T00:00:00","2019-02-28T00:00:00","2019-03-31T00:00:00","2019-04-30T00:00:00","2019-05-31T00:00:00","2019-06-30T00:00:00","2019-07-31T00:00:00","2019-08-31T00:00:00","2019-09-30T00:00:00","2019-10-31T00:00:00","2019-11-30T00:00:00","2019-12-31T00:00:00","2020-01-31T00:00:00","2020-02-29T00:00:00","2020-03-31T00:00:00","2020-04-30T00:00:00","2020-05-31T00:00:00","2020-06-30T00:00:00","2020-07-31T00:00:00","2020-08-31T00:00:00","2020-09-30T00:00:00","2020-10-31T00:00:00","2020-11-30T00:00:00","2020-12-31T00:00:00","2021-01-31T00:00:00","2021-02-28T00:00:00"],"xaxis":"x","y":[626874.0676,670982.2388,656087.4219999999,612906.2991,606906.1812999999,603400.5686,577175.8145999999,610978.9535,623354.4513000001,610432.5743000001,587581.0212,624620.1289,702082.9283,767165.5998999999,696811.0356,644227.0759,647935.8301,651813.8837,671710.6201000001,663830.6401,676417.5676999999,681959.3601,653762.6939000001,661952.4648000001,767640.0707,767487.3114,738788.7232,694677.7651999999,660191.0352,659704.4028,700960.1549,690322.8751000001,683557.1166,643745.3765,619076.1048000001,632985.6324,746081.7505,717835.9465,692266.7934,649364.9394,645139.7025,633539.9532,638771.0206,638066.1165,625955.3932,606406.266,613957.8835,653227.9911000001,707649.8301,750273.4704,733379.7174,660721.5679,634480.9488,636145.1316,642323.6165,644557.6690999999,622485.7848,596824.7599,591358.6177,646929.9177,710055.8339000001,735671.7929,707802.0342,670584.1305,632170.9654,617891.2159000001,619922.4324,628353.137,578354.2446999999,564151.7512,564775.8963,578774.2115999999,656908.8061,657804.7711,661765.0665,643955.7535999999,624322.3637999999,621955.3252,632613.8006,644384.1872,621793.7511,615821.0552000001,583741.6982,597014.7254,705109.154,691145.3848,695560.5034,780478.3247,834686.9262999999,896530.8047,924679.9045,851887.1787,839431.998,837488.3606,805185.9905,803269.2088,868048.5686,804475.8031],"yaxis":"y","type":"scatter"},{"hovertemplate":"Label=RNN\u003cbr\u003eTime=%{x}\u003cbr\u003eUnemployed persons=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"RNN","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"RNN","orientation":"v","showlegend":true,"x":["2013-01-31T00:00:00","2013-02-28T00:00:00","2013-03-31T00:00:00","2013-04-30T00:00:00","2013-05-31T00:00:00","2013-06-30T00:00:00","2013-07-31T00:00:00","2013-08-31T00:00:00","2013-09-30T00:00:00","2013-10-31T00:00:00","2013-11-30T00:00:00","2013-12-31T00:00:00","2014-01-31T00:00:00","2014-02-28T00:00:00","2014-03-31T00:00:00","2014-04-30T00:00:00","2014-05-31T00:00:00","2014-06-30T00:00:00","2014-07-31T00:00:00","2014-08-31T00:00:00","2014-09-30T00:00:00","2014-10-31T00:00:00","2014-11-30T00:00:00","2014-12-31T00:00:00","2015-01-31T00:00:00","2015-02-28T00:00:00","2015-03-31T00:00:00","2015-04-30T00:00:00","2015-05-31T00:00:00","2015-06-30T00:00:00","2015-07-31T00:00:00","2015-08-31T00:00:00","2015-09-30T00:00:00","2015-10-31T00:00:00","2015-11-30T00:00:00","2015-12-31T00:00:00","2016-01-31T00:00:00","2016-02-29T00:00:00","2016-03-31T00:00:00","2016-04-30T00:00:00","2016-05-31T00:00:00","2016-06-30T00:00:00","2016-07-31T00:00:00","2016-08-31T00:00:00","2016-09-30T00:00:00","2016-10-31T00:00:00","2016-11-30T00:00:00","2016-12-31T00:00:00","2017-01-31T00:00:00","2017-02-28T00:00:00","2017-03-31T00:00:00","2017-04-30T00:00:00","2017-05-31T00:00:00","2017-06-30T00:00:00","2017-07-31T00:00:00","2017-08-31T00:00:00","2017-09-30T00:00:00","2017-10-31T00:00:00","2017-11-30T00:00:00","2017-12-31T00:00:00","2018-01-31T00:00:00","2018-02-28T00:00:00","2018-03-31T00:00:00","2018-04-30T00:00:00","2018-05-31T00:00:00","2018-06-30T00:00:00","2018-07-31T00:00:00","2018-08-31T00:00:00","2018-09-30T00:00:00","2018-10-31T00:00:00","2018-11-30T00:00:00","2018-12-31T00:00:00","2019-01-31T00:00:00","2019-02-28T00:00:00","2019-03-31T00:00:00","2019-04-30T00:00:00","2019-05-31T00:00:00","2019-06-30T00:00:00","2019-07-31T00:00:00","2019-08-31T00:00:00","2019-09-30T00:00:00","2019-10-31T00:00:00","2019-11-30T00:00:00","2019-12-31T00:00:00","2020-01-31T00:00:00","2020-02-29T00:00:00","2020-03-31T00:00:00","2020-04-30T00:00:00","2020-05-31T00:00:00","2020-06-30T00:00:00","2020-07-31T00:00:00","2020-08-31T00:00:00","2020-09-30T00:00:00","2020-10-31T00:00:00","2020-11-30T00:00:00","2020-12-31T00:00:00","2021-01-31T00:00:00","2021-02-28T00:00:00"],"xaxis":"x","y":[655709.353016977,588476.5968465484,582476.73091866,673609.0049964387,595809.8930710733,586201.1301631635,579634.6380077121,639734.590857463,587410.6153483863,616664.1368376118,691737.3304554197,638375.1524738161,605157.5413749381,580659.1630682105,567045.4224607289,609583.4711855813,603774.9819460852,570121.9546978807,553858.9146187434,592778.4950580777,585963.36311973,588240.8478494546,638564.8900143652,644033.5278948734,570247.1641771031,549837.5413222773,575323.1108322191,605738.186846869,560473.8398863472,577716.7526618709,583964.1134402425,595210.5950851172,635306.0540604258,634054.0992959074,693647.5760544036,622128.3226607869,662927.1438881732,614631.3299304186,530298.8413722666,686929.4791972991,590669.743713122,606543.0619779098,542948.4500448112,655953.12168904,597081.5258466345,567857.8137847695,684823.1824556463,633220.1560606514,599986.095824874,593351.0353969546,549868.3721281933,594657.139698767,602431.3337454309,585880.3266905451,540504.6700597733,588045.1961975917,594284.5506859953,570251.1343743918,603116.1021715654,652109.2602789202,580973.1546048169,552607.264620407,549102.0252083926,622893.7099789607,558746.2027703328,578129.2742813969,592019.9896897685,576297.8272142846,649309.8181595922,581425.7323849546,716958.2887871484,589048.7665238526,637139.7292154355,670892.0000700867,474965.4604368352,713319.3970489805,557183.057023312,654105.3603646562,500836.5838776658,651626.0246682671,634684.9158709199,517327.2513469951,676227.2800944684,635550.6453952569,579612.5877626047,615026.2986652512,537360.6691794854,583461.4139785663,584645.3729368232,611217.0014467759,530846.432068846,572224.7919315227,603772.7662135735,572271.2976034975,558574.6029360694,656942.9239971101,582793.1852954933,574574.1685324828],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Time"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Unemployed persons"}},"legend":{"title":{"text":"Label"},"tracegroupgap":0}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('31fd0a7c-f1c5-4619-a4a0-c99d6b980700');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="issues-with-rnn" class="slide level4">
<h4>Issues with RNN</h4>
<ul>
<li class="fragment">Vanishing gradient problem.</li>
<li class="fragment">Cannot capture long term dependencies.</li>
</ul>
</section>
<section id="lstm-and-gru" class="slide level4">
<h4>LSTM and GRU</h4>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lstm.png" class="quarto-figure quarto-figure-center" style="width:200.0%"></p>
</figure>
</div>

<aside class="notes">
<ul>
<li>LSTMs uses gates to control the flow of information and selectively retain or forget information across time steps.</li>
<li>This architecture allows them to maintain long-term dependencies while avoiding the vanishing gradient issue that happens in traditional RNNs.</li>
<li>LSTM is more expensive to train than RNNs.</li>
<li>GRU is faster and still performs well.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>Images from <a href="https://www.youtube.com/watch?v=8HyCNIVRbSU&amp;t=108s">Illustrated Guide to LSTM’s and GRU’s: A step by step explanation</a></p>
</div></aside></section>
<section id="lstm-or-gru-cells-look-complex-however-they-are-already-implemented-in-pytorch." class="slide level4">
<h4>LSTM or GRU cells look complex, however, they are already implemented in <code>pytorch</code>.</h4>
<div class="fragment">
<div id="59450ee7" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="5,9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="kw">class</span> LSTM(nn.Module):</span>
<span id="cb3-2"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, output_size, hidden_dim):</span>
<span id="cb3-3"><a href=""></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb3-4"><a href=""></a>        <span class="va">self</span>.hidden_dim <span class="op">=</span> hidden_dim</span>
<span id="cb3-5"><a href=""></a>        <span class="va">self</span>.lstm_cell <span class="op">=</span> nn.LSTM(input_size, hidden_dim, batch_first<span class="op">=</span><span class="va">True</span>, num_layers<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-6"><a href=""></a>        <span class="va">self</span>.fc <span class="op">=</span> nn.Linear(hidden_dim, output_size)</span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, hidden):   </span>
<span id="cb3-9"><a href=""></a>        prediction, (hn, cn) <span class="op">=</span> <span class="va">self</span>.lstm_cell(x, hidden)</span>
<span id="cb3-10"><a href=""></a>        output <span class="op">=</span> <span class="va">self</span>.fc(prediction)</span>
<span id="cb3-11"><a href=""></a>        <span class="cf">return</span> output[:, <span class="op">-</span><span class="dv">1</span>, :], (hn, cn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="transformer-attention-is-all-you-need" class="slide level4">
<h4>Transformer: attention is all you need</h4>
<ul>
<li class="fragment">Text can be viewed as time series data — a sequence of tokens over time.</li>
<li class="fragment">Q: What is the most powerful model for text generation?
<ul>
<li class="fragment">Transformer!</li>
</ul></li>
</ul>
<div class="r-stack">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="transformer_movie.png" class="fragment quarto-figure quarto-figure-center" style="width:20.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="transformer.png" class="fragment quarto-figure quarto-figure-center" style="width:28.0%"></p>
</figure>
</div>
</div>
</section>
<section id="transformers-are-now-widely-used-for-time-series-forecasting" class="slide level4">
<h4>Transformers are now widely used for time series forecasting</h4>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tft.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
<ul>
<li class="fragment"><code>PyTorch Forecasting</code> provides implementations of many state-of-the-art deep learning models.</li>
</ul>
</section>
<section id="additional-topics" class="slide level4">
<h4>Additional topics</h4>
<ul>
<li class="fragment"><strong>Multivariate series</strong>:
<ul>
<li class="fragment"><a href="https://www.statsmodels.org/dev/vector_ar.html">Vector Autoregression</a>: Generalization of autoregression.</li>
</ul></li>
<li class="fragment"><strong>Explanatory variables</strong>:
<ul>
<li class="fragment"><a href="https://robjhyndman.com/hyndsight/arimax/">Regression with ARIMA errors</a>: fit a linear regression to your data and then model the residual with an ARIMA model.</li>
</ul></li>
<li class="fragment"><strong>Time series classification</strong>:
<ul>
<li class="fragment">We usually use machine learning models.</li>
</ul></li>
<li class="fragment">Deep learning models support all of these!</li>
</ul>
</section>
<section id="summary" class="slide level4 scrollable">
<h4>Summary</h4>
<ul>
<li class="fragment">Statistical models like ARIMA is still popular in industry because it is fast and easy to use.</li>
<li class="fragment">Deep learning models can provide improvement over statistical models.</li>
<li class="fragment">How to choose between the two?
<ul>
<li class="fragment"><strong>Data size</strong>: do we have enough data to train a deep learning model?</li>
<li class="fragment"><strong>Complexity</strong>: do we need a model that can capture complex patterns?</li>
<li class="fragment"><strong>Interpretability</strong>: do we need to understand how the model makes predictions?</li>
</ul></li>
</ul>
<aside class="notes">
<ul>
<li>Deep learning models take more effort to build and maintain but can provide improvement over statistical models.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>DSCI 574</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture6_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture6_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture6_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lecture6_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>